/*!
jQuery fileupload plugin v.10.32.0 <https://github.com/blueimp/jQuery-File-Upload>
(C) 2010-2021 Sebastian Tschan <https://blueimp.net>
License MIT
*/
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery-ui/ui/widget"],e):"object"==typeof exports?e(require("jquery"),require("./vendor/jquery.ui.widget")):e(window.jQuery)}(function($){"use strict";function e(e){var t="dragover"===e;return function(i){i.dataTransfer=i.originalEvent&&i.originalEvent.dataTransfer;var r=i.dataTransfer;r&&-1!==$.inArray("Files",r.types)&&!1!==this._trigger(e,$.Event(e,{delegatedEvent:i}))&&(i.preventDefault(),t&&(r.dropEffect="copy"))}}var t;$.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||$('<input type="file"/>').prop("disabled")),$.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),$.support.xhrFormDataFileUpload=!!window.FormData,$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),$.widget("blueimp.fileupload",{options:{dropZone:$(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,uniqueFilenames:void 0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(e,t){return e=this.messages[e]||e.toString(),t&&$.each(t,function(t,i){e=e.replace("{"+t+"}",i)}),e},formData:function(e){return e.serializeArray()},add:function(e,t){if(e.isDefaultPrevented())return!1;(t.autoUpload||!1!==t.autoUpload&&$(this).fileupload("option","autoUpload"))&&t.process().done(function(){t.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_promisePipe:(t=$.fn.jquery.split("."),Number(t[0])>1||Number(t[1])>7?"then":"pipe"),_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:$.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var r=e-this.timestamp;return(!this.bitrate||!i||r>i)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(e){return!e.forceIframeTransport&&(!e.multipart&&$.support.xhrFileUpload||$.support.xhrFormDataFileUpload)},_getFormData:function(e){var t;return"function"==typeof e.formData?e.formData(e.form):Array.isArray(e.formData)?e.formData:"object"==typeof e.formData?(t=[],$.each(e.formData,function(e,i){t.push({name:e,value:i})}),t):[]},_getTotal:function(e){var t=0;return $.each(e,function(e,i){t+=i.size||1}),t},_initProgressObject:function(e){var t={loaded:0,total:0,bitrate:0};e._progress?$.extend(e._progress,t):e._progress=t},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)Object.prototype.hasOwnProperty.call(e._response,t)&&delete e._response[t];else e._response={}},_onProgress:function(e,t){if(e.lengthComputable){var i,r=Date.now?Date.now():(new Date).getTime();if(t._time&&t.progressInterval&&r-t._time<t.progressInterval&&e.loaded!==e.total)return;t._time=r,i=Math.floor(e.loaded/e.total*(t.chunkSize||t._progress.total))+(t.uploadedBytes||0),this._progress.loaded+=i-t._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(r,this._progress.loaded,t.bitrateInterval),t._progress.loaded=t.loaded=i,t._progress.bitrate=t.bitrate=t._bitrateTimer.getBitrate(r,i,t.bitrateInterval),this._trigger("progress",$.Event("progress",{delegatedEvent:e}),t),this._trigger("progressall",$.Event("progressall",{delegatedEvent:e}),this._progress)}},_initProgressListener:function(e){var t=this,i=e.xhr?e.xhr():$.ajaxSettings.xhr();i.upload&&($(i.upload).on("progress",function(i){var r=i.originalEvent;i.lengthComputable=r.lengthComputable,i.loaded=r.loaded,i.total=r.total,t._onProgress(i,e)}),e.xhr=function(){return i})},_deinitProgressListener:function(e){var t=e.xhr?e.xhr():$.ajaxSettings.xhr();t.upload&&$(t.upload).off("progress")},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_getUniqueFilename:function(e,t){return t[e=String(e)]?(e=e.replace(/(?: \(([\d]+)\))?(\.[^.]+)?$/,function(e,t,i){return" ("+(t?Number(t)+1:1)+")"+(i||"")}),this._getUniqueFilename(e,t)):(t[e]=!0,e)},_initXHRData:function(e){var t,i=this,r=e.files[0],n=e.multipart||!$.support.xhrFileUpload,o=Array.isArray(e.paramName)?e.paramName[0]:e.paramName;e.headers=$.extend({},e.headers),e.contentRange&&(e.headers["Content-Range"]=e.contentRange),n&&!e.blob&&this._isInstanceOf("File",r)||(e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.uploadName||r.name)+'"'),n?$.support.xhrFormDataFileUpload&&(e.postMessage?(t=this._getFormData(e),e.blob?t.push({name:o,value:e.blob}):$.each(e.files,function(i,r){t.push({name:Array.isArray(e.paramName)&&e.paramName[i]||o,value:r})})):(i._isInstanceOf("FormData",e.formData)?t=e.formData:(t=new FormData,$.each(this._getFormData(e),function(e,i){t.append(i.name,i.value)})),e.blob?t.append(o,e.blob,r.uploadName||r.name):$.each(e.files,function(r,n){if(i._isInstanceOf("File",n)||i._isInstanceOf("Blob",n)){var s=n.uploadName||n.name;e.uniqueFilenames&&(s=i._getUniqueFilename(s,e.uniqueFilenames)),t.append(Array.isArray(e.paramName)&&e.paramName[r]||o,n,s)}})),e.data=t):(e.contentType=r.type||"application/octet-stream",e.data=e.blob||r),e.blob=null},_initIframeSettings:function(e){var t=$("<a></a>").prop("href",e.url).prop("host");e.dataType="iframe "+(e.dataType||""),e.formData=this._getFormData(e),e.redirect&&t&&t!==location.host&&e.formData.push({name:e.redirectParamName||"redirect",value:e.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(e){var t=$(e.fileInput),i=e.paramName;return i?Array.isArray(i)||(i=[i]):(i=[],t.each(function(){for(var e=$(this),t=e.prop("name")||"files[]",r=(e.prop("files")||[1]).length;r;)i.push(t),r-=1}),i.length||(i=[t.prop("name")||"files[]"])),i},_initFormSettings:function(e){e.form&&e.form.length||(e.form=$(e.fileInput.prop("form")),e.form.length||(e.form=$(this.options.fileInput.prop("form")))),e.paramName=this._getParamName(e),e.url||(e.url=e.form.prop("action")||location.href),e.type=(e.type||"string"==typeof e.form.prop("method")&&e.form.prop("method")||"").toUpperCase(),"POST"!==e.type&&"PUT"!==e.type&&"PATCH"!==e.type&&(e.type="POST"),e.formAcceptCharset||(e.formAcceptCharset=e.form.attr("accept-charset"))},_getAJAXSettings:function(e){var t=$.extend({},this.options,e);return this._initFormSettings(t),this._initDataSettings(t),t},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(e,t,i){var r=$.Deferred(),n=r.promise();return t=t||this.options.context||n,!0===e?r.resolveWith(t,i):!1===e&&r.rejectWith(t,i),n.abort=r.promise,this._enhancePromise(n)},_addConvenienceMethods:function(e,t){var i=this,r=function(e){return $.Deferred().resolveWith(i,e).promise()};t.process=function(e,n){return(e||n)&&(t._processQueue=this._processQueue=(this._processQueue||r([this]))[i._promisePipe](function(){return t.errorThrown?$.Deferred().rejectWith(i,[t]).promise():r(arguments)})[i._promisePipe](e,n)),this._processQueue||r([this])},t.submit=function(){return"pending"!==this.state()&&(t.jqXHR=this.jqXHR=!1!==i._trigger("submit",$.Event("submit",{delegatedEvent:e}),this)&&i._onSend(e,this)),this.jqXHR||i._getXHRPromise()},t.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",i._trigger("fail",null,this),i._getXHRPromise(!1))},t.state=function(){return this.jqXHR?i._getDeferredState(this.jqXHR):this._processQueue?i._getDeferredState(this._processQueue):void 0},t.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===i._getDeferredState(this._processQueue)},t.progress=function(){return this._progress},t.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),r=i&&i.length>1&&parseInt(i[1],10);return r&&r+1},_chunkedUpload:function(e,t){e.uploadedBytes=e.uploadedBytes||0;var i,r,n=this,o=e.files[0],s=o.size,a=e.uploadedBytes,l=e.maxChunkSize||s,p=this._blobSlice,u=$.Deferred(),d=u.promise();return!(!(this._isXHRUpload(e)&&p&&(a||("function"==typeof l?l(e):l)<s))||e.data)&&(!!t||(a>=s?(o.error=e.i18n("uploadedBytes"),this._getXHRPromise(!1,e.context,[null,"error",o.error])):(r=function(){var t=$.extend({},e),d=t._progress.loaded;t.blob=p.call(o,a,a+("function"==typeof l?l(t):l),o.type),t.chunkSize=t.blob.size,t.contentRange="bytes "+a+"-"+(a+t.chunkSize-1)+"/"+s,n._trigger("chunkbeforesend",null,t),n._initXHRData(t),n._initProgressListener(t),i=(!1!==n._trigger("chunksend",null,t)&&$.ajax(t)||n._getXHRPromise(!1,t.context)).done(function(i,o,l){a=n._getUploadedBytes(l)||a+t.chunkSize,d+t.chunkSize-t._progress.loaded&&n._onProgress($.Event("progress",{lengthComputable:!0,loaded:a-t.uploadedBytes,total:a-t.uploadedBytes}),t),e.uploadedBytes=t.uploadedBytes=a,t.result=i,t.textStatus=o,t.jqXHR=l,n._trigger("chunkdone",null,t),n._trigger("chunkalways",null,t),a<s?r():u.resolveWith(t.context,[i,o,l])}).fail(function(e,i,r){t.jqXHR=e,t.textStatus=i,t.errorThrown=r,n._trigger("chunkfail",null,t),n._trigger("chunkalways",null,t),u.rejectWith(t.context,[e,i,r])}).always(function(){n._deinitProgressListener(t)})},this._enhancePromise(d),d.abort=function(){return i.abort()},r(),d)))},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(e,t,i,r){var n=r._progress.total,o=r._response;r._progress.loaded<n&&this._onProgress($.Event("progress",{lengthComputable:!0,loaded:n,total:n}),r),o.result=r.result=e,o.textStatus=r.textStatus=t,o.jqXHR=r.jqXHR=i,this._trigger("done",null,r)},_onFail:function(e,t,i,r){var n=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total),n.jqXHR=r.jqXHR=e,n.textStatus=r.textStatus=t,n.errorThrown=r.errorThrown=i,this._trigger("fail",null,r)},_onAlways:function(e,t,i,r){this._trigger("always",null,r)},_onSend:function(e,t){t.submit||this._addConvenienceMethods(e,t);var i,r,n,o,s=this,a=s._getAJAXSettings(t),l=function(){return s._sending+=1,a._bitrateTimer=new s._BitrateTimer,i=i||((r||!1===s._trigger("send",$.Event("send",{delegatedEvent:e}),a))&&s._getXHRPromise(!1,a.context,r)||s._chunkedUpload(a)||$.ajax(a)).done(function(e,t,i){s._onDone(e,t,i,a)}).fail(function(e,t,i){s._onFail(e,t,i,a)}).always(function(e,t,i){if(s._deinitProgressListener(a),s._onAlways(e,t,i,a),s._sending-=1,s._active-=1,a.limitConcurrentUploads&&a.limitConcurrentUploads>s._sending)for(var r=s._slots.shift();r;){if("pending"===s._getDeferredState(r)){r.resolve();break}r=s._slots.shift()}0===s._active&&s._trigger("stop")})};return this._beforeSend(e,a),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(n=$.Deferred(),this._slots.push(n),o=n[s._promisePipe](l)):(this._sequence=this._sequence[s._promisePipe](l,l),o=this._sequence),o.abort=function(){return r=[void 0,"abort","abort"],i?i.abort():(n&&n.rejectWith(a.context,r),l())},this._enhancePromise(o)):l()},_onAdd:function(e,t){var i,r,n,o,s=this,a=!0,l=$.extend({},this.options,t),p=t.files,u=p.length,d=l.limitMultiFileUploads,h=l.limitMultiFileUploadSize,f=l.limitMultiFileUploadSizeOverhead,c=0,g=this._getParamName(l),_=0;if(!u)return!1;if(h&&void 0===p[0].size&&(h=void 0),(l.singleFileUploads||d||h)&&this._isXHRUpload(l))if(l.singleFileUploads||h||!d)if(!l.singleFileUploads&&h)for(n=[],i=[],o=0;o<u;o+=1)c+=p[o].size+f,(o+1===u||c+p[o+1].size+f>h||d&&o+1-_>=d)&&(n.push(p.slice(_,o+1)),(r=g.slice(_,o+1)).length||(r=g),i.push(r),_=o+1,c=0);else i=g;else for(n=[],i=[],o=0;o<u;o+=d)n.push(p.slice(o,o+d)),(r=g.slice(o,o+d)).length||(r=g),i.push(r);else n=[p],i=[g];return t.originalFiles=p,$.each(n||p,function(r,o){var l=$.extend({},t);return l.files=n?o:[o],l.paramName=i[r],s._initResponseObject(l),s._initProgressObject(l),s._addConvenienceMethods(e,l),a=s._trigger("add",$.Event("add",{delegatedEvent:e}),l)}),a},_replaceFileInput:function(e){var t=e.fileInput,i=t.clone(!0),r=t.is(document.activeElement);e.fileInputClone=i,$("<form></form>").append(i)[0].reset(),t.after(i).detach(),r&&i.trigger("focus"),$.cleanData(t.off("remove")),this.options.fileInput=this.options.fileInput.map(function(e,r){return r===t[0]?i[0]:r}),t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(e,t){var i,r=this,n=$.Deferred(),o=[],s=function(t){t&&!t.entry&&(t.entry=e),n.resolve([t])},a=function(){i.readEntries(function(i){i.length?(o=o.concat(i),a()):function(i){r._handleFileTreeEntries(i,t+e.name+"/").done(function(e){n.resolve(e)}).fail(s)}(o)},s)};return t=t||"",e.isFile?e._file?(e._file.relativePath=t,n.resolve(e._file)):e.file(function(e){e.relativePath=t,n.resolve(e)},s):e.isDirectory?(i=e.createReader(),a()):n.resolve([]),n.promise()},_handleFileTreeEntries:function(e,t){var i=this;return $.when.apply($,$.map(e,function(e){return i._handleFileTreeEntry(e,t)}))[this._promisePipe](function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(e){var t=(e=e||{}).items;return t&&t.length&&(t[0].webkitGetAsEntry||t[0].getAsEntry)?this._handleFileTreeEntries($.map(t,function(e){var t;return e.webkitGetAsEntry?((t=e.webkitGetAsEntry())&&(t._file=e.getAsFile()),t):e.getAsEntry()})):$.Deferred().resolve($.makeArray(e.files)).promise()},_getSingleFileInputFiles:function(e){var t,i,r=(e=$(e)).prop("entries");if(r&&r.length)return this._handleFileTreeEntries(r);if((t=$.makeArray(e.prop("files"))).length)void 0===t[0].name&&t[0].fileName&&$.each(t,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(!(i=e.prop("value")))return $.Deferred().resolve([]).promise();t=[{name:i.replace(/^.*\\/,"")}]}return $.Deferred().resolve(t).promise()},_getFileInputFiles:function(e){return e instanceof $&&1!==e.length?$.when.apply($,$.map(e,this._getSingleFileInputFiles))[this._promisePipe](function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(e)},_onChange:function(e){var t=this,i={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(i.fileInput).always(function(r){i.files=r,t.options.replaceFileInput&&t._replaceFileInput(i),!1!==t._trigger("change",$.Event("change",{delegatedEvent:e}),i)&&t._onAdd(e,i)})},_onPaste:function(e){var t=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,i={files:[]};t&&t.length&&($.each(t,function(e,t){var r=t.getAsFile&&t.getAsFile();r&&i.files.push(r)}),!1!==this._trigger("paste",$.Event("paste",{delegatedEvent:e}),i)&&this._onAdd(e,i))},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var t=this,i=e.dataTransfer,r={};i&&i.files&&i.files.length&&(e.preventDefault(),this._getDroppedFiles(i).always(function(i){r.files=i,!1!==t._trigger("drop",$.Event("drop",{delegatedEvent:e}),r)&&t._onAdd(e,r)}))},_onDragOver:e("dragover"),_onDragEnter:e("dragenter"),_onDragLeave:e("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),$.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(e,t){var i=-1!==$.inArray(e,this._specialOptions);i&&this._destroyEventHandlers(),this._super(e,t),i&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var e=this.options;void 0===e.fileInput?e.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):e.fileInput instanceof $||(e.fileInput=$(e.fileInput)),e.dropZone instanceof $||(e.dropZone=$(e.dropZone)),e.pasteZone instanceof $||(e.pasteZone=$(e.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(e,t){return"url"!==e&&"string"==typeof t&&/^\/.*\/[igm]{0,3}$/.test(t)},_initDataAttributes:function(){var e=this,t=this.options,i=this.element.data();$.each(this.element[0].attributes,function(r,n){var o,s=n.name.toLowerCase();/^data-/.test(s)&&(s=s.slice(5).replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()}),o=i[s],e._isRegExpOption(s,o)&&(o=e._getRegExp(o)),t[s]=o)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(e){var t=this;e&&!this.options.disabled&&(e.fileInput&&!e.files?this._getFileInputFiles(e.fileInput).always(function(i){e.files=i,t._onAdd(null,e)}):(e.files=$.makeArray(e.files),this._onAdd(null,e)))},send:function(e){if(e&&!this.options.disabled){if(e.fileInput&&!e.files){var t,i,r=this,n=$.Deferred(),o=n.promise();return o.abort=function(){return i=!0,t?t.abort():(n.reject(null,"abort","abort"),o)},this._getFileInputFiles(e.fileInput).always(function(o){i||(o.length?(e.files=o,(t=r._onSend(null,e)).then(function(e,t,i){n.resolve(e,t,i)},function(e,t,i){n.reject(e,t,i)})):n.reject())}),this._enhancePromise(o)}if(e.files=$.makeArray(e.files),e.files.length)return this._onSend(null,e)}return this._getXHRPromise(!1,e&&e.context)}})});
