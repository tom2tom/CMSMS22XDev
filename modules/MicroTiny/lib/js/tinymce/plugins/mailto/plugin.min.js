tinymce.PluginManager.add("mailto",function(t,e){function a(){selectedNode=t.selection.getNode(),anchorElm=!1;var e="A"==selectedNode.tagName&&t.dom.getAttrib(selectedNode,"href").startsWith("mailto:");email_val="",text_val="",e?(email_val=t.dom.getAttrib(selectedNode,"href").replace("mailto:",""),anchorElm=t.dom.getParent(selectedNode,'a[href*="mailto:"]'),text_val=anchorElm.innerText,console.log(selectedNode)):text_val=t.selection.getContent({format:"text"}),t.windowManager.open({title:cmsms_tiny.mailto_heading,body:[{type:"textbox",name:"email",size:40,label:cmsms_tiny.prompt_email,value:email_val},{type:"textbox",name:"text",size:40,label:cmsms_tiny.prompt_linktext,value:text_val}],onsubmit:function(e){""!=e.data.text?link_text=e.data.text:link_text=e.data.email;e.data.email;anchorElm&&t.selection.select(anchorElm),t.execCommand("mceInsertContent",!1,t.dom.createHTML("a",{href:"mailto:"+e.data.email},link_text))}})}t.addMenuItem("mailto",{text:cmsms_tiny.mailto_text,title:cmsms_tiny.mailto_title,image:cmsms_tiny.mailto_image,stateSelector:'a[href*="mailto:"]',context:"insert",prependToContext:!0,onclick:a}),t.addButton("mailto",{text:"@",tooltip:cmsms_tiny.mailto_title,onclick:a,stateSelector:'a[href*="mailto:"]'})});